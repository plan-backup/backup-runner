INFO:__main__:ğŸš€ Starting PostgreSQL 14 Build & Test Pipeline
INFO:__main__:============================================================
INFO:__main__:ğŸ“‹ Step 1: Starting test database...
INFO:__main__:ğŸ˜ Starting PostgreSQL 14 container...
INFO:__main__:â³ Waiting for PostgreSQL to be ready...
INFO:__main__:âœ… PostgreSQL is ready!
INFO:__main__:ğŸ“‹ Step 2: Starting MinIO S3 storage...
INFO:__main__:ğŸ“¦ Starting MinIO S3-compatible storage container...
INFO:__main__:â³ Waiting for MinIO to be ready...
INFO:__main__:âœ… MinIO is ready!
INFO:__main__:âœ… MinIO bucket 'planb-backups' created successfully
INFO:__main__:ğŸ“‹ Step 3: Setting up test data...
INFO:__main__:ğŸ“Š Setting up test data...
INFO:__main__:âœ… Test data created: 3 movies, 3 actors
INFO:__main__:ğŸ“‹ Step 4: Building Plan B container...
INFO:__main__:ğŸ”¨ Building Plan B PostgreSQL container for testing...
INFO:__main__:âœ… Container built successfully for local testing!
INFO:__main__:ğŸ“‹ Step 5: Testing complete backup pipeline...
INFO:__main__:ğŸ’¾ Testing complete backup pipeline with our container...
INFO:__main__:â–¶ï¸  Running complete backup pipeline using our Plan B container...
INFO:__main__:Using MinIO container name: planb_test_minio_1758627374
INFO:__main__:Container output: 
INFO:__main__:âœ… Complete backup pipeline executed successfully!
INFO:__main__:âœ… Backup verified in MinIO: 1259 bytes
INFO:__main__:âœ… Backup uploaded and verified: backups/test/1758627377/postgresql-backup.tar.gz
INFO:__main__:ğŸ“‹ Step 6: Pushing to production registry...
INFO:__main__:â˜ï¸  Building production image and pushing to GCR...
INFO:__main__:ğŸ”¨ Building production image for linux/amd64...
INFO:__main__:âœ… Production image built successfully!
INFO:__main__:â¬†ï¸  Pushing to Google Container Registry...
ERROR:__main__:âŒ Failed to push to GCR: ERROR: (gcloud.auth.docker-helper) There was a problem refreshing your current auth tokens: Reauthentication failed. cannot prompt during non-interactive execution.
Please run:

  $ gcloud auth login

to obtain new credentials.

If you have already logged in with a different account, run:

  $ gcloud config set account ACCOUNT

to select an already authenticated account to use.
denied: Unauthenticated request. Unauthenticated requests do not have permission "artifactregistry.repositories.uploadArtifacts" on resource "projects/apito-cms/locations/us/repositories/gcr.io" (or it may not exist)

ERROR:__main__:âŒ Failed to push to GCR, but tests passed
INFO:__main__:ğŸ§¹ Cleaning up...
INFO:__main__:âœ… ArangoDB test container stopped
INFO:__main__:âœ… MinIO test container stopped
INFO:__main__:âœ… Test network removed
